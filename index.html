<script>
    const animationDuration = 800; // Animation duration in ms
    const attackLock = {}; // Prevents multiple attacks during animation

    function replaceSprite(player, action, callback) {
        const originalSrc = player.img.src;
        const actionSrc = originalSrc.replace(/(\w+)\.png$/, `${action}$1.png`); // Generates attack sprite URL
        player.img.src = actionSrc; // Sets attack sprite

        setTimeout(() => {
            player.img.src = originalSrc; // Reverts back to the original sprite
            if (callback) callback();
        }, animationDuration);
    }

    window.addEventListener('keydown', e => {
        const key = e.key.toLowerCase();

        // Player 1 attacks
        if (key === 'q' && !attackLock['q']) {
            attackLock['q'] = true;
            replaceSprite(player1, 'punch', () => {
                applyKnockback(player2, punchDamage, player2.damage);
                attackLock['q'] = false;
            });
        } else if (key === 'e' && !attackLock['e']) {
            attackLock['e'] = true;
            replaceSprite(player1, 'kick', () => {
                applyKnockback(player2, kickDamage, player2.damage);
                attackLock['e'] = false;
            });
        }

        // Player 2 attacks
        if (key === 'm' && !attackLock['m']) {
            attackLock['m'] = true;
            replaceSprite(player2, 'punch', () => {
                applyKnockback(player1, punchDamage, player1.damage);
                attackLock['m'] = false;
            });
        } else if (key === 'n' && !attackLock['n']) {
            attackLock['n'] = true;
            replaceSprite(player2, 'kick', () => {
                applyKnockback(player1, kickDamage, player1.damage);
                attackLock['n'] = false;
            });
        }
    });
</script>
